---
id: security-hardening-p1
name: Security Hardening - Phase 1 Threat
description: "Security Hardening Phase 1: 攻撃面マッピングフェーズ。攻撃対象領域、信頼境界、悪用シナリオをマッピングし、深刻度を評価する。結果はPhase 2（認証・認可監査）に引き継ぐ。"
enabled: enabled
strategy: parallel
skills:
  - vuln-scanner          # チーム共通: 脆弱性スキャン
  - secret-detector       # チーム共通: 機密情報検出
triggers:
  - セキュリティ監査
  - 脅威モデリング
  - 新機能のセキュリティレビュー
  - インシデントレスポンス後の再発防止
skip_conditions:
  - なし（内部システムでも脅威はある）
members:
  - id: attack-surface-mapper
    role: Attack Surface Mapper
    description: "攻撃面マッピング担当。外部に公開される攻撃対象領域を特定する。"
    enabled: true
  - id: trust-boundary-analyst
    role: Trust Boundary Analyst
    description: "信頼境界分析担当。信頼境界、データフロー境界を特定する。"
    enabled: true
  - id: exploit-scenario-designer
    role: Exploit Scenario Designer
    description: "悪用シナリオ設計担当。想定される悪用シナリオを特定し、深刻度を評価する。"
    enabled: true
---

# Security Hardening - Phase 1: Threat Modeling

## チームミッション

Security HardeningのPhase 1（攻撃面マッピング）を担当。セキュリティリスクを包括的に特定する。

**核心原則:** セキュリティは設計の基盤に組み込む。後付けの対策は不完全で、常に傍受される。

**鉄の掟:**
```
入力は全て検証する
最小権限の原則を徹底する
```

**出力:** 脅威分析結果は Phase 2（security-hardening-p2）に引き継がれる。

## When to Use

以下の技術的シナリオで使用する:
- セキュリティ監査
- 脅威モデリング
- 認証・認可の実装レビュー
- セキュリティパッチレビュー
- 新機能のセキュリティレビュー
- インシデントレスポンス後の再発防止
- コンプライアンス要件への対応

**特に以下の場合に使用する:**
- 新機能がユーザー入力や認証に関わる場合
- 外部からのアクセスを受けるAPIやエンドポイントを追加する場合
- 機密データを扱う機能を実装する場合
- 依存ライブラリにセキュリティアドバイザリが発表された場合
- 過去にセキュリティインシデントがあった場合

**以下の場合でもスキップしてはならない:**
- 「内部システムだからセキュリティは不要」と思ったとき（内側からの脅威もある）
- 「小さな機能だから問題ない」と思ったとき（小さな穴も水を漏らす）
- 「フレームワークがやってくれる」と思ったとき（デフォルト設定は不十分）
- 「以前は問題なかった」と思ったとき（脅威は進化する）

## Output Format

```
SUMMARY: [脅威分析サマリー]
CLAIM: [主要なセキュリティリスク]
EVIDENCE: [攻撃面マップ、悪用シナリオ]
CONFIDENCE: [0.00-1.00]
RESULT:
## 攻撃面
- [攻撃面1]: [深刻度]
- [攻撃面2]: [深刻度]

## 信頼境界
- [境界1]: [説明]
- [境界2]: [説明]

## 悪用シナリオ
- [シナリオ1]: [深刻度: 高/中/低]
- [シナリオ2]: [深刻度]
NEXT_STEP: Phase 2（security-hardening-p2）で認証・認可監査
```

## 警告信号 - プロセスの遵守を促す

以下のような考えが浮かんだら、それはSTOPのサイン:
- 「内部システムだからセキュリティは不要」
- 「フレームワークがやってくれる」
- 「以前は問題なかった」
- 「この脆弱性は悪用されにくい」
- 「CVSSスコアは低いから優先度は低い」

**これらすべては: STOP。Phase 1を完了せよ。**

## 人間のパートナーの「やり方が間違っている」シグナル

**以下の方向転換に注意:**
- 「それは信頼境界を越えているか？」 - 境界の認識が不明確
- 「この入力は検証されているか？」 - 入力検証の欠如
- 「同じ問題は他にないか？」 - 網羅性の欠如

**これらを見たら:** STOP。Phase 1を完了せよ。

## よくある言い訳

| 言い訳 | 現実 |
|--------|------|
| 「内部システムだから不要」 | 内側からの脅威、傍受、内部者の悪意がある。 |
| 「フレームワークがやってくれる」 | デフォルト設定は不十分。明示的な設定が必要。 |
| 「以前は問題なかった」 | 脅威は進化する。過去の安全≠未来の安全。 |
| 「悪用されにくい」 | 「悪用されにくい」≠「悪用されない」。 |
| 「CVSSは低い」 | CVSSは参考値。ビジネスインパクトで判断。 |
