---
id: mermaid-diagram-p1
name: Mermaid Diagram - Phase 1 Analysis
description: "Mermaid Diagram Phase 1: コード解析フェーズ。対象コードの構造、制御フロー、データフロー、インターフェースを詳細に分析し、図解に必要な情報を抽出する。結果はPhase 2（図式作成）に引き継ぐ。"
enabled: enabled
strategy: parallel
triggers:
  - シーケンス図の作成（API呼び出し、イベントフロー、プロセス間通信）
  - フローチャートの作成（アルゴリズム、条件分岐、業務フロー）
  - 状態遷移図の作成（ステートマシン、ライフサイクル）
  - クラス図の作成（データモデル、継承関係）
  - ER図の作成（データベーススキーマ、エンティティ関係）
skip_conditions:
  - なし（単純さは主観）
members:
  - id: structure-analyzer
    role: Structure Analyzer
    description: "構造分析担当。クラス、関数、モジュールの構造を分析し、関係性を特定する。"
    enabled: true
  - id: flow-analyzer
    role: Flow Analyzer
    description: "フロー分析担当。制御フロー、条件分岐、ループ、例外処理を特定する。"
    enabled: true
  - id: interface-analyzer
    role: Interface Analyzer
    description: "インターフェース分析担当。API、メソッドシグネチャ、データフローを抽出する。"
    enabled: true
---

# Mermaid Diagram - Phase 1: Code Analysis

## チームミッション

Mermaid DiagramのPhase 1（コード解析）を担当。図解に必要な情報を正確に抽出する。

**核心原則:** 推測で図を作成しない。正確性を速度より優先する。

**鉄の掟:**
```
コードと図の不一致は致命的である
推測で図を作成しない
```

**出力:** 解析結果は Phase 2（mermaid-diagram-p2）に引き継がれる。

## When to Use

以下の視覚化タスクで使用する:
- シーケンス図の作成（API呼び出し、イベントフロー、プロセス間通信）
- フローチャートの作成（アルゴリズム、条件分岐、業務フロー）
- 状態遷移図の作成（ステートマシン、ライフサイクル）
- クラス図の作成（データモデル、継承関係）
- ER図の作成（データベーススキーマ、エンティティ関係）

**特に以下の場合に使用する:**
- 複雑なコードフローの理解が必要な場合
- 新規メンバーのオンボーディング
- 設計レビューやアーキテクチャ議論
- ドキュメント作成時の視覚化
- LLMによるコード理解の支援
- バグ調査時のフロー可視化

**以下の場合でもスキップしてはならない:**
- 「単純なフローだから省略できる」と思ったとき（単純さは主観）
- 「コードを読めば分かる」と思ったとき（図は理解を加速する）
- 「時間がない」と思ったとき（不正確な図は時間の浪費）

## Output Format

```
SUMMARY: [コード解析サマリー]
CLAIM: [主要な構造・フロー]
EVIDENCE: [抽出した情報（ファイル:行番号）]
CONFIDENCE: [0.00-1.00]
RESULT:
## 構造
- クラス/モジュール: [...]
- 関係性: [...]

## 制御フロー
- 条件分岐: [...]
- ループ: [...]
- 例外処理: [...]

## インターフェース
- API: [...]
- データフロー: [...]
NEXT_STEP: Phase 2（mermaid-diagram-p2）で図式作成
```

## 警告信号 - プロセスの遵守を促す

以下のような考えが浮かんだら、それはSTOPのサイン:
- 「だいたい合っているだろう」
- 「細かい条件分岐は省略しよう」
- 「この関数は重要じゃないからスキップ」
- 「時間がないから検証は省略」
- 「目視で確認したから大丈夫」

**これらすべては: STOP。Phase 1を完了せよ。**

## 人間のパートナーの「やり方が間違っている」シグナル

**以下の方向転換に注意:**
- 「この条件分岐、足りないのでは？」 - 網羅性の不足
- 「この関数名、違くない？」 - 正確性の問題

**これらを見たら:** STOP。Phase 1を完了せよ。

## よくある言い訳

| 言い訳 | 現実 |
|--------|------|
| 「だいたい合っている」 | だいたいは不正確。コードと図は完全に一致させる。 |
| 「細かい条件は省略」 | 省略された条件は隠れたバグの温床。 |
| 「重要じゃない関数」 | 重要かどうかは文脈次第。網羅性を保つ。 |
| 「時間がない」 | 不正確な図は時間の浪費。正確な図を作る。 |
| 「目視で確認」 | 目視は見落とす。体系的に検証する。 |
