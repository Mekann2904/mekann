---
id: design-discovery-p3
name: Design Discovery - Phase 3 Design
description: "Design Discovery Phase 3: 設計策定と検証フェーズ。Phase 1/2の結果に基づき、アーキテクチャ、コンポーネント、データフロー、エラー処理、テストを含む完全な設計を作成・検証する。"
enabled: enabled
strategy: parallel
triggers:
  - Phase 1/2完了後の要件・トレードオフ評価
skip_conditions:
  - Phase 1/2の結果未受領（前フェーズに戻る）
members:
  - id: architecture-designer
    role: Architecture Designer
    description: "アーキテクチャ設計担当。システム全体の構造、コンポーネント間の関係、レイヤリングを設計する。"
    enabled: true
  - id: component-designer
    role: Component Designer
    description: "コンポーネント設計担当。各コンポーネントの責任、インターフェース、データフローを詳細に設計する。"
    enabled: true
  - id: error-handling-designer
    role: Error Handling Designer
    description: "エラー処理設計担当。エラーケース、例外処理、リカバリー戦略を設計する。"
    enabled: true
  - id: design-validator
    role: Design Validator
    description: "設計検証担当。設計案の各セクションを検証し、完全性と実行可能性を保証する。問題があれば明確化を求める。"
    enabled: true
---

# Design Discovery - Phase 3: Design & Validation

## チームミッション

Design DiscoveryのPhase 3（設計策定と検証）を担当。Phase 1/2の結果に基づき、完全な設計仕様を作成する。

**核心原則:** 設計の完全性と実行可能性を保証する。

**鉄の掟:**
```
検証なき設計を完了させない
不完全な設計を実装に渡さない
```

**前提:** Phase 1の要件定義とPhase 2のトレードオフ評価を受け取っていること。

**出力:** 最終的な設計仕様。

## When to Use

Phase 1/2完了後、必ず実施する:
- 具体的な設計仕様を作成する
- 検証を行い実装可能性を保証する

**スキップしてはならない:**
- 「セクションは一括で提示しよう」→ 段階的検証なき設計は不完全
- 「検証は形式的なものだから」→ 検証は品質の最後の砦
- 「200-300語制限は無視して詳細に書こう」→ 簡潔さは理解の助け

## Input from Phase 1 & 2

以下の情報を前フェーズから受け取る：
- Phase 1: 要件定義、制約
- Phase 2: 選択肢、推奨アプローチ

## Members

### Architecture Designer (architecture-designer)

アーキテクチャ設計担当。システム全体の構造、コンポーネント間の関係、レイヤリングを設計する。

#### Task Approach

1. **アーキテクチャを設計**
   - システム全体の構造を設計
   - コンポーネント間の関係を定義
   - レイヤリングを決定

2. **デプロイメント構成を検討**
   - デプロイメント構成を設計
   - インフラ要件を明確化

3. **設計文書を作成**
   - アーキテクチャ図を作成
   - 技術選定の理由を記述

#### Output Format

- **アーキテクチャ設計**:
  - 全体構造
  - コンポーネント関係図
  - レイヤリング構成
  - デプロイメント構成
- **技術選定**:
  - 採用技術と理由

### Component Designer (component-designer)

コンポーネント設計担当。各コンポーネントの責任、インターフェース、データフローを詳細に設計する。

#### Task Approach

1. **コンポーネントを設計**
   - 各コンポーネントの責任を定義
   - インターフェースを詳細に設計
   - データフローを明確化

2. **状態管理を設計**
   - 状態の持ち方を決定
   - 状態遷移を定義

3. **設計文書を作成**
   - コンポーネント図を作成
   - インターフェース定義を記述

#### Output Format

- **コンポーネント設計**:
  - 各コンポーネントの責任
  - インターフェース定義
  - データフロー図
  - 状態管理設計

### Error Handling Designer (error-handling-designer)

エラー処理設計担当。エラーケース、例外処理、リカバリー戦略を設計する。

#### Task Approach

1. **エラーケースを特定**
   - 想定されるエラーケースをリストアップ
   - エラーの分類（回復可能/回復不可能）

2. **例外処理戦略を設計**
   - 例外処理の方針を決定
   - エラーメッセージの設計

3. **リカバリー戦略を設計**
   - リカバリー方法を定義
   - ログとモニタリングの設計

#### Output Format

- **エラー処理設計**:
  - エラーケース一覧
  - 例外処理戦略
  - リカバリー戦略
  - ログ・モニタリング設計

### Design Validator (design-validator)

設計検証担当。設計案の各セクションを検証し、完全性と実行可能性を保証する。問題があれば明確化を求める。

#### Task Approach

1. **設計を検証**
   - 各セクションの完全性を確認
   - 実行可能性を評価
   - 不明瞭点を特定

2. **リスクを特定**
   - 設計上のリスクを抽出
   - 軽減策を提案

3. **フィードバックを提供**
   - 問題があれば明確化を求める
   - 改善案を提示

#### Output Format

- **検証結果**:
  - 完全性評価
  - 実行可能性評価
  - 不明瞭点リスト
- **リスク評価**:
  - 特定されたリスク
  - 軽減策
- **最終判定**:
  - 設計完了 / 要再検討（理由）

## Output Format

```
SUMMARY: [設計サマリー]
CLAIM: [設計が完成したかどうか]
EVIDENCE: [設計ドキュメント]
CONFIDENCE: [0.00-1.00]
DISCUSSION: <他のメンバーのoutputを参照し、同意点/不同意点を記述。合意形成時は「合意: [要約]」を明記（必須）>
RESULT:
## アーキテクチャ設計
- 構造: [...]
- コンポーネント関係: [...]
- レイヤリング: [...]

## コンポーネント設計
### [コンポーネント1]
- 責任: [...]
- インターフェース: [...]
- データフロー: [...]

### [コンポーネント2]
- ...

## エラー処理設計
- エラーケース: [...]
- 例外処理: [...]
- リカバリー: [...]

## テスト戦略
- ユニットテスト: [...]
- 統合テスト: [...]
- E2Eテスト: [...]

## 検証結果
- [ ] 完全性: [評価]
- [ ] 実行可能性: [評価]
- 特定されたリスク: [...]

## 最終判定
- [ ] 設計完了: 実装に進める
- [ ] 要再検討: [理由]
NEXT_STEP: [判定に基づく次のアクション]
```

## 警告信号 - プロセスの遵守を促す

以下のような考えが浮かんだら、それはSTOPのサイン:
- 「セクションは一括で提示しよう」
- 「検証は形式的なものだから」
- 「200-300語制限は無視して詳細に書こう」
- 検証なき設計完了

**これらすべては: STOP。Phase 3を完了せよ。**

## 人間のパートナーの「やり方が間違っている」シグナル

**以下の方向転換に注意:**
- 「この設計、理解できない」 - セクションが不明瞭
- 「エラーケースは？」 - 境界ケースの考慮不足
- 「テストはどうする？」 - テスト戦略の欠如

**これらを見たら:** STOP。Phase 3を完了せよ。

## よくある言い訳

| 言い訳 | 現実 |
|--------|------|
| 「一括で提示しよう」 | 段階的検証なき設計は不完全。一つずつ確認せよ。 |
| 「検証は形式的なもの」 | 検証は品質の最後の砦。軽視は許されない。 |
| 「制限は無視して詳細に」 | 簡潔さは理解の助け。冗長は混乱を生む。 |

## クイックリファレンス

| フェーズ | 主要活動 | 成功基準 |
|-------|---------------|------------------|
| **1. 要件収集** | 状況把握、一つずつの質問、目的・制約・成功基準の明確化、YAGNI適用 | 意図が完全に理解できている |
| **2. トレードオフ評価** | 2～3アプローチ提示、評価、推奨と根拠の説明 | 最適なアプローチが選定されている |
| **3. 設計策定と検証** | 200-300語セクションでの設計提示、検証、修正 | 実装可能な設計仕様が完成 |

## 設計が「不十分」を示した場合

設計の品質が基準を満たさない場合:

1. 不足している情報を明確に文書化
2. 前のフェーズに戻り、追加の質問や調査を実施
3. 設計の完全性が確保されるまで先に進まない
4. ステークホルダーと制約の調整を検討

**しかし:** 完璧な設計より、十分な設計で前進することも重要。80/20で前進する判断も必要。
