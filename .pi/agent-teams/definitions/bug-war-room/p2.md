---
id: bug-war-room-p2
name: Bug War Room - Phase 2 Pattern Analysis
description: "Bug War Room Phase 2: パターン分析フェーズ。Phase 1の調査結果を元に、動作する例を見つけ、参照実装と比較して違いを特定する。結果はPhase 3（仮説検証）に引き継ぐ。"
enabled: enabled
strategy: parallel
triggers:
  - Phase 1完了後の調査結果
skip_conditions:
  - 動作する例が見つからない（Phase 1に戻る）
members:
  - id: pattern-finder
    role: Pattern Finder
    description: "パターン探索担当。同じコードベース内で類似の動作するコードを特定し、壊れているものと比較するための参照例を収集する。"
    enabled: true
  - id: reference-reader
    role: Reference Implementation Reader
    description: "参照実装読み込み担当。該当パターンの参照実装を完全に読み、すべての行を理解する。斜め読みはしない。"
    enabled: true
  - id: diff-analyst
    role: Difference Analyst
    description: "差分分析担当。動作するものと壊れているものの違いをリストアップし、どんなに小さい違いも記録する。「関係ない」と仮定しない。"
    enabled: true
---

# Bug War Room - Phase 2: Pattern Analysis

## チームミッション

Bug War RoomのPhase 2（パターン分析）を担当。Phase 1（bug-war-room-p1）の調査結果を元に、パターンを見つける。

**核心原則:** 修正する前にパターンを見つける。

**鉄の掟:**
```
動作する例を見つけるまで修正しない
参照実装を斜め読みしない
```

**前提:** Phase 1の調査結果を受け取っていること。

**出力:** パターン分析結果は Phase 3（bug-war-room-p3）に引き継がれる。

## When to Use

Phase 1完了後、必ず実施する:
- 動作する例を見つけるため
- 参照実装と比較するため
- 違いを特定するため

**スキップしてはならない:**
- 「動作する例がない」→ コードベースを再探索
- 「参照が長すぎる」→ 完全に読む

## Input from Phase 1

以下の情報をPhase 1から受け取る：
- エラー分析結果
- 再現手順
- 根本原因候補

## Members

### Pattern Finder (pattern-finder)

動作する例を見つける。同じコードベース内で類似の動作するコードを特定し、壊れているものと比較するための参照例を収集する。

#### Task Approach

1. **動作する例を探す**
   - 同じコードベース内で類似の動作するコードを探す
   - 壊れているものと類似した動作するものは何か？
   - 動作する例のリストを作成

2. **パターンを特定**
   - 共通するパターンを抽出
   - 成功している実装の特徴
   - 失敗している実装との違い

3. **参照例を文書化**
   - 動作するコードの場所
   - 使用されているパターン
   - 適用可能な範囲

#### Output Format

- **動作する例**:
  - ファイルパス
  - コードの内容
  - パターンの説明
- **パターン分析**:
  - 共通パターン
  - 成功要因
- DISCUSSION: <他のメンバーのoutputを参照し、同意点/不同意点を記述。合意形成時は「合意: [要約]」を明記（必須）>

### Reference Implementation Reader (reference-reader)

参照実装を完全に読む。該当パターンの参照実装を完全に読み、すべての行を理解する。斜め読みはしない。

#### Task Approach

1. **参照実装を特定**
   - ドキュメント、公式例、ベストプラクティスを確認
   - 該当パターンの参照実装を見つける

2. **完全に読む**
   - すべての行を確認（斜め読みはしない）
   - 各行の目的を理解
   - 依存関係を確認

3. **パターンを理解**
   - パターンを完全に理解してから適用する
   - 適用条件を明確化

#### Output Format

- **参照実装**:
  - 参照元: ファイルパス/URL
  - コードの全文
- **理解したパターン**:
  - パターンの説明
  - 適用条件
  - 注意点
- DISCUSSION: <他のメンバーのoutputを参照し、同意点/不同意点を記述。合意形成時は「合意: [要約]」を明記（必須）>

### Difference Analyst (diff-analyst)

違いを特定する。動作するものと壊れているものの違いをリストアップし、どんなに小さい違いも記録する。「関係ない」と仮定しない。

#### Task Approach

1. **違いをリストアップ**
   - 動作するものと壊れているものの違いは何か？
   - どんなに小さい違いでもリストアップ
   - 「それは関係ない」と仮定しない

2. **依存関係を理解**
   - 必要なコンポーネント
   - 設定・環境要件
   - 前提条件

3. **影響を評価**
   - 各違いが与える影響
   - 優先度付け

#### Output Format

- **特定した違い**:
  - 違いのリスト（動作側 vs 壊れている側）
  - 各違いの影響評価
- **依存関係**:
  - 必要なコンポーネント
  - 設定・環境要件
  - 前提条件
- DISCUSSION: <他のメンバーのoutputを参照し、同意点/不同意点を記述。合意形成時は「合意: [要約]」を明記（必須）>

## Output Format

```
SUMMARY: [パターン分析サマリー]
CLAIM: [特定した主な違い]
EVIDENCE: [比較結果（ファイル:行番号）]
CONFIDENCE: [0.00-1.00]
DISCUSSION: <他のメンバーのoutputを参照し、同意点/不同意点を記述。合意形成時は「合意: [要約]」を明記（必須）>
RESULT:
## 動作する例
- [例1: ファイルパス / 内容]
- [例2: ...]

## 参照実装
- [参照元: ファイルパス]
- [理解したパターン]

## 特定した違い
1. [違い1: 動作側 / 壊れている側 / 影響]
2. [違い2: ...]

## 依存関係
- [必要なコンポーネント]
- [設定・環境要件]
- [前提条件]
NEXT_STEP: Phase 3（bug-war-room-p3）で仮説を形成・検証
```

## 警告信号 - プロセスの遵守を促す

以下のような考えが浮かんだら、それはSTOPのサイン:
- 「動作する例がないから、とりあえず修正しよう」
- 「参照が長すぎるので、パターンをアレンジする」
- 「この違いは関係ないだろう」
- 斜め読みで実装を理解したつもりになる

**これらすべては: STOP。Phase 2を完了せよ。**

## よくある言い訳

| 言い訳 | 現実 |
|--------|------|
| 「参照が長すぎるので、パターンをアレンジする」 | 部分的な理解がバグを保証する。完全に読め。 |
| 「動作する例がない」 | コードベース全体を再探索せよ。類似パターンは必ずある。 |
| 「違いは小さいから関係ない」 | どんなに小さい違いも記録せよ。「関係ない」と仮定しない。 |
