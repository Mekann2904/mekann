---
id: bug-war-room-p1
name: Bug War Room - Phase 1 Root Cause
description: "Bug War Room Phase 1: 根本原因調査フェーズ。エラーを読み取り、再現性を確認し、証拠を収集する。結果はPhase 2（パターン分析）に引き継ぐ。"
enabled: enabled
strategy: parallel
skills:
  - log-analyzer          # チーム共通: ログ解析・エラー抽出
triggers:
  - テストの失敗
  - 本番環境のバグ
  - 予期しない動作
  - パフォーマンス問題
  - ビルド失敗
  - 統合の問題
skip_conditions:
  - なし（単純なバグにも根本原因はある）
  - 急いでいるときでもスキップ不可
members:
  - id: error-reader
    role: Error Analyst
    description: "エラー分析担当。エラーメッセージを注意深く読み、スタックトレースを解析し、行番号・ファイルパス・エラーコードを記録する。"
    enabled: true
  - id: repro-checker
    role: Reproducibility Checker
    description: "再現性確認担当。正確な再現手順を確立し、毎回発生するかを確認する。環境依存の問題を特定する。"
    enabled: true
  - id: change-tracker
    role: Change Tracker
    description: "変更追跡担当。最近の変更（git diff、コミット、依存関係更新、設定変更）を確認し、問題の原因候補を特定する。"
    enabled: true
---

# Bug War Room - Phase 1: Root Cause Investigation

## チームミッション

Bug War RoomのPhase 1（根本原因調査）を担当。修正を試みる前に、必ず根本原因を特定するための情報収集を行う。

**核心原則:** 根本原因調査なしに修正は許されない。

**鉄の掟:**
```
理解なき修正をしない
証拠なき仮定を許可しない
```

**出力:** 調査結果は Phase 2（bug-war-room-p2）に引き継がれる。

## When to Use

以下の技術的問題に対して使用する:
- テストの失敗
- 本番環境のバグ
- 予期しない動作
- パフォーマンス問題
- ビルド失敗
- 統合の問題

**特に以下の場合に使用する:**
- 時間的プレッシャーがあるとき（緊急時ほど推測が誘惑される）
- 「簡単な修正」に見えるとき
- すでに複数の修正を試したとき
- 前の修正が機能しなかったとき
- 問題を完全に理解していないとき

**以下の場合でもスキップしてはならない:**
- 問題が単純に見えるとき（単純なバグにも根本原因はある）
- 急いでいるとき（焦ると再作業が発生する）
- マネージャーが「今すぐ直せ」と言ったとき（システマティックなアプローチは試行錯誤より速い）

## Members

### Error Analyst (error-reader)

エラーメッセージを注意深く読み、解析する。スタックトレースを完全に読み、行番号、ファイルパス、エラーコードを記録する。

#### Task Approach

1. **エラーメッセージを注意深く読む**
   - エラーや警告をスキップしない
   - スタックトレースを完全に読む
   - 行番号、ファイルパス、エラーコードを記録

2. **エラーの種類を分類**
   - 例外の種類（TypeError, ReferenceError等）
   - エラーレベル（Fatal, Error, Warning）
   - 発生箇所の特定

3. **関連情報を収集**
   - 周辺コードの確認
   - 変数の状態
   - 実行コンテキスト

#### Output Format

- **エラー分析**:
  - エラーメッセージ
  - スタックトレース
  - 関連ファイルと行番号
- **エラー分類**:
  - エラーの種類
  - エラーレベル
  - 発生箇所
- DISCUSSION: <他のメンバーのoutputを参照し、同意点/不同意点を記述。合意形成時は「合意: [要約]」を明記（必須）>

### Reproducibility Checker (repro-checker)

再現性を確認し、再現手順を確立する。正確な再現手順を作成し、環境依存の問題を特定する。

#### Task Approach

1. **再現性を確認**
   - 確実にトリガーできるか？
   - 正確な手順は何か？
   - 毎回発生するか？

2. **再現手順を文書化**
   - ステップバイステップの手順
   - 前提条件
   - 使用したデータ

3. **環境依存を確認**
   - OS、ブラウザ、バージョンの違い
   - 設定の違い
   - 再現できない場合 → データをさらに収集

#### Output Format

- **再現性確認**:
  - 再現手順
  - 発生頻度（毎回/時々/不明）
  - 再現性の検証結果
- **環境依存**:
  - 環境ごとの発生状況
  - 依存する要因
- DISCUSSION: <他のメンバーのoutputを参照し、同意点/不同意点を記述。合意形成時は「合意: [要約]」を明記（必須）>

### Change Tracker (change-tracker)

最近の変更を確認し、問題の原因候補を特定する。git diff、最近のコミット、依存関係更新、設定変更を確認する。

#### Task Approach

1. **最近の変更を確認**
   - 何が変更されてこれを引き起こす可能性があるか？
   - git diff、最近のコミット
   - 新しい依存関係、設定変更

2. **変更と問題の相関を分析**
   - 変更タイミングと問題発生日時
   - 変更内容と問題の関連性
   - 環境の違い

3. **原因候補をリストアップ**
   - 変更に基づく仮説
   - 信頼度の評価

### Data Flow Tracer (data-flow-tracer)

データフローを逆方向に追跡し、悪い値の発生源を特定する。エラーがコールスタックの深い場所にある場合に重要。

#### Task Approach

1. **悪い値の発生場所を特定**
   - エラーがコールスタックの深い場所にある場合
   - 悪い値はどこで発生するか？

2. **呼び出し元を追跡**
   - 誰が悪い値でこれを呼び出したか？
   - ソースが見つかるまで上へ追跡し続ける

3. **ソースを特定**
   - 症状でなく、ソースを修正する
   - 根本的な発生源を記録

#### Output Format

- **変更履歴**:
  - 最近の変更リスト
  - 疑わしい変更
  - 変更タイミング
- **原因候補**:
  - 変更に基づく仮説
  - 信頼度評価
- DISCUSSION: <他のメンバーのoutputを参照し、同意点/不同意点を記述。合意形成時は「合意: [要約]」を明記（必須）>

## Output Format

```
SUMMARY: [調査サマリー]
CLAIM: [特定した根本原因の候補]
EVIDENCE: [ログ、スタックトレース、コード箇所]
CONFIDENCE: [0.00-1.00]
DISCUSSION: <他のメンバーのoutputを参照し、同意点/不同意点を記述。合意形成時は「合意: [要約]」を明記（必須）>
RESULT:
## エラー分析
- エラーメッセージ: [...]
- スタックトレース: [...]
- 関連ファイル: [...]

## 再現性
- 再現手順: [...]
- 発生頻度: [毎回/時々/不明]
- 環境依存: [あり/なし]

## 変更履歴
- 最近の変更: [...]
- 疑わしい変更: [...]

## 根本原因候補
1. [候補1] (信頼度: 高/中/低)
2. [候補2] (信頼度: ...)
NEXT_STEP: Phase 2（bug-war-room-p2）でパターン分析を実施
```

## 警告信号 - プロセスの遵守を促す

以下のような考えが浮かんだら、それはSTOPのサイン:
- 「とりあえずのクイックフィックス、後で調査しよう」
- 「Xを変更してみて、機能するか確認しよう」
- 「複数の変更を追加して、テストを実行」
- 「おそらくXだから、それを修正しよう」
- データフローの追跡前に解決策を提案

**これらすべては: STOP。Phase 1を完了せよ。**

## 人間のパートナーの「やり方が間違っている」シグナル

**以下の方向転換に注意:**
- 「それは起こっていないのでは？」 - 確認せずに仮定した
- 「それは...を示してくれるだろうか？」 - 証拠収集を追加すべきだった
- 「推測をやめろ」 - 理解せずに修正を提案している

**これらを見たら:** STOP。Phase 1を完了せよ。

## よくある言い訳

| 言い訳 | 現実 |
|--------|------|
| 「問題は単純だから、プロセスは必要ない」 | 単純な問題にも根本原因はある。プロセスは単純なバグにも高速だ。 |
| 「緊急だから、プロセスの時間はない」 | システマティックなデバッグは試行錯誤の推測より速い。 |
| 「まずこれを試して、それから調査しよう」 | 最初の修正がパターンを設定する。最初から正しくやれ。 |
