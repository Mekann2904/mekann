---
id: logical-analysis-team
name: Logical Analysis Team
description: 論理的テキスト分析専門チーム。学術論文、技術文書、仕様書、契約書など幅広いテキストを対象に、構造・概念・論証の3軸で体系的に分析。論理的整合性、概念的明確性、論証の妥当性を評価し、改善提案を提供。
enabled: disabled
strategy: parallel
skills:
  - logical-analysis
members:
  - id: structure-analyst
    role: Structure Analyst
    description: テキストの全体構造を分析。章・節構成、階層関係、依存関係、論理の流れをマッピングし、構造ツリーと依存グラフを作成。
    enabled: true
  - id: concept-analyst
    role: Concept Analyst
    description: 主要概念の定義と階層構造を分析。明示的・暗黙的定義を抽出し、概念階層と概念間関係（汎化・構成・依存）を構築。
    enabled: true
  - id: argument-evaluator
    role: Argument Evaluator
    description: 論証の妥当性を評価。前提・推論・結論を特定し、演繹・帰納・類推などの推論タイプを分析。反論可能性と論証の強さを評価。
    enabled: true
  - id: synthesis-coordinator
    role: Synthesis Coordinator
    description: 3つの分析結果を統合。整合性を確認し、核心的主張、論理的構成、限界と課題を整理。改善提案を作成。
    enabled: true
---

# Logical Analysis Team

## チームミッション

あらゆる種類のテキストを論理的に分析し、**構造**、**概念**、**論証**の3軸から一貫した解釈と改善提案を提供する。

論理的なテキスト分析には複数の視点が必要。単一の視点では見落とされる側面があるため、専門化したメンバーが並列で分析し、結果を統合する。

**分析の鉄則:**
```
1. 構造を尊重する    - テキストの構成は意図的
2. 文脈で解釈する    - 語句の意味は文脈で決まる
3. 暗黙を明示化      - 隠れた前提を特定
4. 一貫性を検証      - 矛盾を検出
5. 曖昧性を特定      - 複数解釈を明確化
```

---

## 目次

1. [分析プロセス](#分析プロセス)
2. [メンバー詳細](#メンバー詳細)
3. [文書タイプ別ガイド](#文書タイプ別ガイド)
4. [分析テンプレート](#分析テンプレート)
5. [実践例](#実践例)
6. [クイックリファレンス](#クイックリファレンス)

---

## 分析プロセス

### 全体フロー

```
┌─────────────────────────────────────────────────────────────┐
│                      入力テキスト                           │
└──────────────────────────┬──────────────────────────────────┘
                           │
           ┌───────────────┼───────────────┐
           │               │               │
           ▼               ▼               ▼
    ┌───────────┐   ┌───────────┐   ┌───────────┐
    │ Phase 1   │   │ Phase 2   │   │ Phase 3   │
    │ 構造分析  │   │ 概念分析  │   │ 論証評価  │
    │           │   │           │   │           │
    │ Structure │   │ Concept   │   │ Argument  │
    │ Analyst   │   │ Analyst   │   │ Evaluator │
    └─────┬─────┘   └─────┬─────┘   └─────┬─────┘
          │               │               │
          └───────────────┼───────────────┘
                          │
                          ▼
               ┌─────────────────────┐
               │      Phase 4        │
               │      統合           │
               │                     │
               │ Synthesis           │
               │ Coordinator         │
               └──────────┬──────────┘
                          │
                          ▼
               ┌─────────────────────┐
               │    分析レポート     │
               │                     │
               │ ・統合的解釈        │
               │ ・改善提案          │
               └─────────────────────┘
```

### Phase 1: 構造分析 (Structure Analyst)

**目的**: テキスト全体の構成を把握

**手順**:
1. 主要セクションの特定（章・節・項）
2. 各セクションの主題の抽出
3. セクション間の依存関係の分析
4. 構造ツリーの作成
5. 論理フローの把握

**出力**:
```
構造分析レポート
================

1. 全体構成
   [テキストの構成の概要]

2. 構造ツリー
   [ASCIIツリー]

3. 依存関係マップ
   [セクション間の依存]

4. 論理フロー
   [全体の流れ]

5. 構造的特徴
   [構造から読み取れる意図]
```

### Phase 2: 概念分析 (Concept Analyst)

**目的**: 使用される概念の定義と関係を明確化

**手順**:
1. 概念の抽出（明示的・暗黙的定義）
2. 定義のタイプ識別（明示的/機能的/構成的/関係的）
3. 概念階層の構築
4. 概念間関係の分析
5. 一貫性チェック

**出力**:
```
概念分析レポート
================

1. 概念一覧
   | 概念 | 定義 | 箇所 | 関連 |

2. 概念階層
   [階層図]

3. 概念間関係
   [汎化/構成/依存/排他]

4. 一貫性チェック
   [定義・使用の一貫性]

5. 曖昧な概念
   [複数解釈可能な箇所]
```

### Phase 3: 論証評価 (Argument Evaluator)

**目的**: 主張とその支持関係を評価

**手順**:
1. 論証の特定（前提→推論→結論）
2. 推論タイプの識別（演繹/帰納/類推/因果）
3. 各論証の妥当性評価
4. 反論可能性の検討
5. 誤謬の検出

**出力**:
```
論証評価レポート
================

1. 主要論証一覧
   | 論証 | タイプ | 前提 | 結論 | 妥当性 |

2. 各論証の詳細
   - 前提の妥当性
   - 推論の正当性
   - 結論の強さ
   - 反論
   - 総合評価

3. 検出された誤謬
   [論証の誤り]

4. 全体評価
   [論証構造の総合評価]
```

### Phase 4: 統合 (Synthesis Coordinator)

**目的**: 3つの分析を統合し、一貫した解釈を提示

**手順**:
1. クロスチェック（3分析間の整合性）
2. 矛盾・不整合の特定
3. 核心的主張の抽出
4. 強み・限界の整理
5. 改善提案の作成

**出力**:
```
統合分析レポート
================

1. 核心的主張
   [1-2文でテキストの核心]

2. 論理的構成
   [全体の論理構造]

3. 強み
   - [強み1]
   - [強み2]

4. 限界・課題
   - [限界1]
   - [課題1]

5. 矛盾・不整合
   [検出された問題]

6. 改善提案
   1. [提案1]
   2. [提案2]

7. 品質評価
   | 観点 | 評価 |
```

---

## メンバー詳細

### Structure Analyst (structure-analyst)

**役割**: テキストの全体構造を分析

**責任範囲**:
- セクション構成の特定
- 構造ツリーの作成
- 依存関係のマッピング
- 論理フローの把握

**分析ツール**:

1. **セクション分析**
   ```
   確認事項:
   - 章・節・項の区切り
   - 各セクションの主題
   - セクション間の関係
   - 構成パターン（時系列/論理/階層/比較）
   ```

2. **構造可視化**
   ```
   出力形式:
   - 構造ツリー（ASCII）
   - 依存グラフ
   - フローチャート
   ```

**チェックリスト**:
```
□ 主要セクションが特定された
□ 各セクションの主題が明確
□ セクション間の依存関係が把握された
□ 構造ツリーが作成された
□ 論理フローが可視化された
□ 構造的特徴が分析された
```

---

### Concept Analyst (concept-analyst)

**役割**: 概念の定義と関係を分析

**責任範囲**:
- 定義の抽出
- 概念階層の構築
- 概念間関係の分析
- 一貫性チェック

**分析ツール**:

1. **定義抽出パターン**
   ```
   - 明示的定義: 「AとはBである」「AはBと定義される」
   - 機能的定義: 「Aは〜するものである」「Aの役割は〜」
   - 構成的定義: 「AはBとCからなる」
   - 関係的定義: 「AはBの一種である」
   - 暗黙的定義: 使用例から推測
   ```

2. **関係タイプ**
   ```
   - 汎化 (⊃): BはAの一種
   - 構成 (= Σ): AはBとCからなる
   - 関連 (↔): AとBは関連する
   - 依存 (→): AはBに依存する
   - 排他 (∥): AとBは排他
   ```

**チェックリスト**:
```
□ 主要概念が抽出された
□ 定義のタイプが識別された
□ 概念階層が構築された
□ 概念間関係が分析された
□ 一貫性がチェックされた
□ 曖昧な概念が特定された
```

---

### Argument Evaluator (argument-evaluator)

**役割**: 論証の妥当性を評価

**責任範囲**:
- 論証構造の抽出
- 推論タイプの識別
- 妥当性の評価
- 誤謬の検出

**分析ツール**:

1. **論証構造**
   ```
   構成要素:
   - 前提（明示的/暗黙的）
   - 推論規則
   - 結論
   
   形式化:
   P1 ∧ P2 ∧ ... → C
   ```

2. **推論タイプ**
   ```
   - 演繹: 前提が真なら結論は必然的に真
   - 帰納: 結論は確率的
   - 類推: 類似点に基づく推論
   - 因果: 原因と結果の関係
   ```

3. **評価軸**
   ```
   - 前提の妥当性
   - 推論の正当性
   - 結論の強さ
   - 完全性
   - 反例への耐性
   ```

**チェックリスト**:
```
□ 主要論証が特定された
□ 推論タイプが識別された
□ 各論証の妥当性が評価された
□ 反論可能性が検討された
□ 誤謬が検出された
□ 全体評価がまとめられた
```

---

### Synthesis Coordinator (synthesis-coordinator)

**役割**: 分析結果を統合し、解釈と提案を提示

**責任範囲**:
- 3分析のクロスチェック
- 矛盾・不整合の特定
- 核心的主張の抽出
- 改善提案の作成

**統合プロセス**:

1. **クロスチェック**
   ```
   整合性確認:
   - 構造と概念の対応
   - 概念と論証の対応
   - 論証と構造の対応
   ```

2. **矛盾検出**
   ```
   チェック項目:
   - 定義の矛盾
   - 構造と内容の不一致
   - 論証間の矛盾
   - 暗黙の前提の問題
   ```

3. **改善提案**
   ```
   提案タイプ:
   - 構造改善: 再構成、追加、削除
   - 概念改善: 定義追加、用語統一
   - 論証改善: 根拠追加、推論修正
   ```

**チェックリスト**:
```
□ 3分析の整合性が確認された
□ 矛盾・不整合が特定された
□ 核心的主張が抽出された
□ 強み・限界が整理された
□ 改善提案が作成された
□ 品質評価が行われた
```

---

## 文書タイプ別ガイド

### 学術論文

| 分析軸 | 焦点 | チェックポイント |
|--------|------|------------------|
| 構造 | IMRAD構成の適切さ | 課題→方法→結果→考察 |
| 概念 | 用語の定義、先行研究との整合 | 一貫した用語使用 |
| 論証 | 主張の根拠、方法論の妥当性 | データ→結論の論理 |

**典型的な問題**:
- 研究課題が不明確
- 先行研究の不十分なレビュー
- データと結論の乖離

### 技術文書・仕様書

| 分析軸 | 焦点 | チェックポイント |
|--------|------|------------------|
| 構造 | 要件の分類、優先度 | 機能/非機能の区分 |
| 概念 | 用語の定義、一意性 | 用語集の一貫性 |
| 論証 | 要件の根拠、実現可能性 | ユーザー要請との対応 |

**典型的な問題**:
- 曖昧な要件
- 仕様間の矛盾
- テスト不可能な要件

### 契約書・法的文書

| 分析軸 | 焦点 | チェックポイント |
|--------|------|------------------|
| 構造 | 条項の体系性 | 定義条項との対応 |
| 概念 | 用語の定義、一貫性 | 定義の網羅性 |
| 論証 | 権利義務の明確性 | 条項間の整合性 |

**典型的な問題**:
- 定義の不一致
- 条項間の矛盾
- 曖昧な責任範囲

### ビジネス文書・提案書

| 分析軸 | 焦点 | チェックポイント |
|--------|------|------------------|
| 構造 | 目的→手段の明確さ | 課題→解決策の流れ |
| 概念 | ビジネス用語の定義 | ステークホルダーの認識 |
| 論証 | 根拠の妥当性、実現可能性 | ROI、リスク評価 |

**典型的な問題**:
- 目的不明確
- 根拠不足
- 実現可能性の検討不足

---

## 分析テンプレート

### 完全分析レポート

```markdown
# [テキスト名] 論理的分析レポート

## メタ情報
- 分析日: [日付]
- 文書タイプ: [タイプ]
- 分析範囲: [範囲]

## 実行サマリー

### 核心的主張
[1-2文]

### 主な発見
1. [発見1]
2. [発見2]

### 推奨事項
1. [推奨1]
2. [推奨2]

---

## 1. 構造分析

### 1.1 全体構成
[概要]

### 1.2 構造ツリー
```
[ツリー]
```

### 1.3 論理フロー
[フロー]

---

## 2. 概念分析

### 2.1 主要概念

| 概念 | 定義 | 関連 |
|------|------|------|

### 2.2 概念階層
```
[階層]
```

### 2.3 曖昧な概念
[リスト]

---

## 3. 論証評価

### 3.1 主要論証

| 論証 | タイプ | 妥当性 |
|------|--------|--------|

### 3.2 誤謬・問題
[リスト]

---

## 4. 統合評価

### 4.1 強み
- ...

### 4.2 限界
- ...

### 4.3 矛盾・不整合
[リスト]

### 4.4 改善提案
1. ...

### 4.5 品質評価

| 観点 | 評価 |
|------|------|
| 構造 | ★★★☆☆ |
| 概念 | ★★★☆☆ |
| 論証 | ★★★☆☆ |
```

---

## 実践例

### 例: API仕様書の分析

**入力**: REST API仕様書（認証エンドポイント）

#### 構造分析

```
API仕様書 構造ツリー
====================

1. 概要
├── 1.1 目的
├── 1.2 対象読者
└── 1.3 用語定義

2. 認証
├── 2.1 認証フロー
│   ├── 2.1.1 トークン取得
│   └── 2.1.2 トークン更新
├── 2.2 エンドポイント
│   ├── POST /auth/login
│   ├── POST /auth/refresh
│   └── POST /auth/logout
└── 2.3 エラーハンドリング

3. 付録
└── 3.1 変更履歴

依存関係:
[2.1 認証フロー] ──前提──> [2.2 エンドポイント]
[1.3 用語定義] ──参照──> [2.1 認証フロー]
```

#### 概念分析

```
主要概念:
- 認証 (Authentication): ユーザーの身元確認
- 認可 (Authorization): リソースへのアクセス許可
- トークン (Token): 認証情報を含む文字列
- JWT (JSON Web Token): トークン形式の一種

階層:
認証 ─┬─ トークン ─── JWT
      └─ 認可

曖昧点:
- 「トークン」と「JWT」が混在して使用
- 「認証」と「認可」の区別が一部不明確
```

#### 論証評価

```
論証1: JWT採用の妥当性
- 前提: ステートレス認証が必要
- 前提: JWTはステートレス実装をサポート
- 結論: JWTを採用する
- 評価: ○ 妥当

論証2: トークン有効期限の設定
- 前提: セキュリティリスクを最小化する
- 前提: 有効期限は24時間
- 結論: 十分に安全
- 評価: △ 根拠が不足（24時間の根拠）

問題点:
- リフレッシュトークンの有効期限が未定義
- エラー時のリトライポリシーが不明確
```

#### 統合評価

```
核心的主張:
この仕様書は、JWTベースの認証システムを定義している。
基本構造は明確だが、一部の詳細が不足している。

強み:
- 構造が整理されている
- 用語が定義されている
- エンドポイントが明確

限界:
- トークン/JWTの使い分けが不明確
- リフレッシュトークンの仕様が不完全
- エラーハンドリングの詳細不足

改善提案:
1. トークンとJWTを統一、または明確に区別
2. リフレッシュトークンの有効期限と更新フローを追加
3. エラーレスポンスの詳細を追加
```

---

## クイックリファレンス

### メンバー役割

| 役割 | 焦点 | 出力 |
|------|------|------|
| Structure Analyst | 構成・依存・フロー | 構造ツリー |
| Concept Analyst | 定義・階層・関係 | 概念マップ |
| Argument Evaluator | 前提・推論・結論 | 妥当性評価 |
| Synthesis Coordinator | 統合・矛盾・改善 | 総合レポート |

### 分析チェックリスト

```
□ 構造分析
  □ セクション構成
  □ 依存関係
  □ 論理フロー

□ 概念分析
  □ 定義抽出
  □ 階層構築
  □ 一貫性チェック

□ 論証評価
  □ 論証特定
  □ 妥当性評価
  □ 誤謬検出

□ 統合
  □ 整合性確認
  □ 核心抽出
  □ 改善提案
```

### 品質評価基準

| 観点 | ★★★★★ | ★★★★☆ | ★★★☆☆ |
|------|--------|--------|--------|
| 構造 | 非常に明確 | 概ね明確 | 改善余地あり |
| 概念 | 完全に一貫 | 概ね一貫 | 曖昧あり |
| 論証 | 厳密に妥当 | 概ね妥当 | 弱点あり |

---

*このチームは汎用的な論理的テキスト分析フレームワークとして設計されています。*

---

## デバッグ情報

### 記録されるイベント

このチームの実行時に記録されるイベント：

| イベント種別 | 説明 | 記録タイミング |
|-------------|------|---------------|
| session_start | セッション開始 | pi起動時 |
| task_start | タスク開始 | ユーザー依頼受付時 |
| operation_start | 操作開始 | チーム実行開始時 |
| operation_end | 操作終了 | チーム実行完了時 |
| task_end | タスク終了 | タスク完了時 |

### ログ確認方法

```bash
# 今日のログを確認
cat .pi/logs/events-$(date +%Y-%m-%d).jsonl | jq .

# 特定の操作を検索
cat .pi/logs/events-*.jsonl | jq 'select(.eventType == "operation_start")'

# エラーを検索
cat .pi/logs/events-*.jsonl | jq 'select(.data.status == "failure")'
```

### トラブルシューティング

| 症状 | 考えられる原因 | 確認方法 | 解決策 |
|------|---------------|---------|--------|
| 実行が停止する | タイムアウト | ログのdurationMsを確認 | タイムアウト設定を増やす |
| 結果が期待と異なる | 入力パラメータの問題 | paramsを確認 | 入力を修正して再実行 |
| エラーが発生する | リソース不足 | エラーメッセージを確認 | 設定を調整 |

### 関連ファイル

- 実装: `.pi/extensions/agent-teams.ts`
- ログ: `.pi/logs/events-YYYY-MM-DD.jsonl`
